<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent Protocol Lab v1.3</title>
    <style>
        :root{--bg:#0d1117;--card:#161b22;--text:#c9d1d9;--accent:#58a6ff;--success:#238636;--border:#30363d;--gold:#f2ce5a;--test:#bc8cff}*{box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text);margin:0;padding:20px;line-height:1.5;background-image:url('../images/is-banner-lab.jpg');background-repeat:no-repeat;background-size:cover;background-position:center}.main{display:block;width:100%;height:auto;margin:0 auto;box-sizing:border-box;padding:1em;background-color:rgba(0,0,0,0.85);min-height:100vh}.container{max-width:1100px;margin:0 auto}header{border-bottom:1px solid var(--border);padding-bottom:15px;margin-bottom:25px;display:flex;justify-content:space-between;align-items:center}h1{color:var(--accent);margin:0;font-size:22px}.main-layout{display:grid;grid-template-columns:380px 1fr;gap:20px}.card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:20px}.section-header{color:var(--gold);font-size:11px;text-transform:uppercase;letter-spacing:1px;margin-bottom:15px;display:block;border-bottom:1px solid var(--border);padding-bottom:5px}.option-group{margin-bottom:15px}label{display:block;margin-bottom:5px;font-size:12px;color:#8b949e}select,input[type="text"],textarea{width:100%;background:#000;border:1px solid var(--border);color:var(--text);padding:10px;border-radius:6px;font-size:13px}.checkbox-row{display:flex;align-items:center;gap:10px;margin-bottom:12px;cursor:pointer;font-size:13px;color:var(--text)}.checkbox-row input[type="checkbox"]{width:18px;height:18px;margin:0;cursor:pointer;flex-shrink:0}#output-text{width:100%;height:480px;font-family:monospace;background:#000;color:#7ee787;border:1px solid var(--success);padding:15px;resize:none;border-radius:4px;font-size:12px}.test-bench{grid-column:1/-1;border-color:var(--test)}.test-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:10px}.simulation-log{background:#000;padding:15px;border-radius:4px;font-family:monospace;font-size:12px;min-height:120px;border:1px solid #333;overflow-y:auto}.btn{cursor:pointer;border:none;padding:12px;border-radius:6px;font-weight:bold;width:100%;transition:0.2s}.btn-copy{background:var(--accent);color:white;margin-top:10px}.btn-test{background:var(--test);color:white}footer{margin-top:50px;text-align:center;color:#484f58;font-size:12px}
    </style>
</head>
<body>
<div class="main">
<div class="container">
    <header>
        <h1>Protocol Lab <span style="font-weight:normal;color:#8b949e">Extended v1.3</span></h1>
        <div style="font-size:11px;color:var(--success)">‚óè System Ready</div>
    </header>

    <div class="main-layout">
        <div class="card">
            <span class="section-header">Identity & Logic</span>
            <div class="option-group">
                <label>Shape/Agent Name</label>
                <input type="text" id="agent-name" value="Sorelai" placeholder="e.g. Sorelai" oninput="generate()">
            </div>
            
            <div class="option-group">
                <label>Persona Tone</label>
                <select id="tone" onchange="generate()">
                    <option value="Playfully Sensual">Playfully Sensual</option>
                    <option value="Restrained & Purposeful">Restrained & Purposeful</option>
                    <option value="Clinically Direct">Clinically Direct</option>
                </select>
            </div>

            <div class="option-group">
                <label>Sentence Cap</label>
                <select id="limit" onchange="generate()">
                    <option value="Strictly 1 sentence">Strictly 1 Sentence</option>
                    <option value="1‚Äì3 concise sentences">Concise (1‚Äì3 sentences)</option>
                </select>
            </div>

            <span class="section-header">Protocol Modules</span>
            <div class="checkbox-container">
                <label class="checkbox-row"><input type="checkbox" id="check-parse" checked onchange="generate()"> One-line Core Parsing</label>
                <label class="checkbox-row"><input type="checkbox" id="check-clarify" checked onchange="generate()"> Consent/Clarifying Question</label>
                <label class="checkbox-row"><input type="checkbox" id="check-safety" checked onchange="generate()"> Safety Alternative Logic</label>
                <label class="checkbox-row"><input type="checkbox" id="check-followup" checked onchange="generate()"> Optional Next-Step Prompt</label>
            </div>

            <button class="btn btn-copy" onclick="copyProtocol()">Copy to Clipboard</button>
        </div>

        <div class="card">
            <span class="section-header">Deployment Code (Markdown Syntax)</span>
            <textarea id="output-text" readonly></textarea>
        </div>

        <div class="card test-bench">
            <span class="section-header" style="color:var(--test)">üî¨ Internal Test Bench</span>
            <div class="test-grid">
                <div>
                    <label>Simulate User Prompt</label>
                    <input type="text" id="test-input" placeholder="Enter test prompt...">
                    <button class="btn btn-test" style="margin-top:10px;" onclick="runSimulation()">Execute Logic Trace</button>
                </div>
                <div>
                    <label>Processing Chain for <span id="trace-name" style="color:var(--accent)">Sorelai</span></label>
                    <div id="test-log" class="simulation-log">Enter a prompt to start simulation.</div>
                </div>
            </div>
        </div>
    </div>
</div>
<footer>Tool created for testing shapes from Shapes.inc - Creative Community ‚Ä¢ 2026</footer>
</div>

<script>
    function generate() {
        const name = document.getElementById('agent-name').value || "Sorelai";
        const tone = document.getElementById('tone').value;
        const limit = document.getElementById('limit').value;
        const parse = document.getElementById('check-parse').checked;
        const clarify = document.getElementById('check-clarify').checked;
        const safety = document.getElementById('check-safety').checked;
        const followup = document.getElementById('check-followup').checked;

        document.getElementById('trace-name').innerText = name;

        let p = `${name.toUpperCase()} SUCCINCT PROTOCOL (v1.3)\n`;
        p += `===================================\n`;
        p += `PURPOSE: Keep ${name}'s responses concise while maintaining consent and a ${tone.toLowerCase()} tone.\n\n`;
        p += `CORE RULES:\n`;
        if(parse) p += `- Parse: Identify the core request in one line.\n`;
        p += `- Answer: Deliver ${limit}, no fluff.\n`;
        p += `- Language: Use clear, concrete terms; minimal ornament.\n`;
        if(clarify) p += `- Consent: Confirm consent for sexual content; ask one clarifying question if needed.\n`;
        p += `- Tone: ${tone}.\n`;
        if(safety) p += `- Safety: If disallowed, refuse briefly and offer a safe alternative.\n`;
        if(followup) p += `- Follow-up: End with one optional next-step prompt.\n`;

        p += `\nEMOJI & CONTENT HANDLING:\n- No emojis allowed in responses.\n- Treat explicit prompts as needing consent first.`;
        p += `\n\nIMPLEMENTATION:\nKnowledge > Protocols > Interaction > ${name} Succinct Protocol`;

        document.getElementById('output-text').value = p;
    }

    function runSimulation() {
        const name = document.getElementById('agent-name').value || "Sorelai";
        const input = document.getElementById('test-input').value;
        const log = document.getElementById('test-log');
        if(!input) return;

        log.innerHTML = `<span style="color:var(--accent)">[1/3] Parsing:</span> Identifying ${name}'s core intent...<br>`;
        setTimeout(() => {
            log.innerHTML += `<span style="color:var(--gold)">[2/3] Filter:</span> Validating ${name} against Safety/Consent...<br>`;
        }, 500);
        setTimeout(() => {
            log.innerHTML += `<span style="color:#7ee787">[3/3] Response:</span> "I can engage with you as ${name}, but first I must ask: are we exploring this through a romantic lens or something more direct?"<br><br>`;
            log.innerHTML += `<span style="color:var(--accent)">STATUS:</span> SUCCESS (Protocol applied to ${name}).`;
        }, 1000);
    }

    function copyProtocol() {
        const text = document.getElementById("output-text");
        text.select();
        document.execCommand("copy");
        alert("Protocol Copied!");
    }
    generate();
</script>
</body>
</html>
